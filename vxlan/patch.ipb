# bridge needs ip for the vxlan peers and know the default gw
netns exec switch0 ip addr add 192.168.0.254/24 dev bridge0
netns exec switch0 ip route add default via 192.168.0.1 dev bridge0
# create vxlan interface with vni 10 using the bridges ips as endpoints,
# without specying the device name, instead enlave it to the bridge
netns exec switch0 ip link add vxlan0 type vxlan id 10 local 192.168.0.254 remote 192.168.1.254 dstport 4789
netns exec switch0 ip link set dev vxlan0 master bridge0
netns exec switch0 ip link set vxlan0 up
# change the ip of the host to a new subnets that will only be reachable
# through the vxlan interface
netns exec host1 ip addr flush eth0
netns exec host1 ip addr add 172.16.0.100/24 dev eth0

# to the same as the other side
netns exec switch1 ip addr add 192.168.1.254/24 dev bridge0
netns exec switch1 ip route add default via 192.168.1.1 dev bridge0
netns exec switch1 ip link add vxlan0 type vxlan id 10 local 192.168.1.254 remote 192.168.0.254 dstport 4789
netns exec switch1 ip link set dev vxlan0 master bridge0
netns exec switch1 ip link set vxlan0 up
netns exec host3 ip addr flush eth0
netns exec host3 ip addr add 172.16.0.101/24 dev eth0
